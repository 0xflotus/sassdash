@function __function-exists($function, $args...) {
    @if type-of($function) != 'string' {
        @return false;
    }

    @return if(function-exists($function),
        true,
        function-exists(__function-name($function))
    );
}


@function __call($method, $this-arg: $__current-scope__, $args...) {
    $function-name: __function-name($method);
    $scope-id: __function-scope($method);

    $_: scope-use(if($scope-id, $scope-id, $this-arg));
        $method-name: this($function-name);

        @if $method-name != null and __function-exists(this($function-name)) {
            $function-name: this($function-name);
        } @else if not ($function-name and __function-exists($function-name)) {
            $_: scope-use-end();

            @return null;
        }

        $result: call($function-name, $args...);
    $_: scope-use-end();

    @return $result;
}


@function __function-scope($function) {
    @if type-of($function) != 'string' {
        @return null;
    }

    $scope-index: str-index($function, '@');
    $scope-id: false;

    @if $scope-index {
        $scope-id: str-slice($function, $scope-index);
    }

    @return $scope-id;
}


@function __function-name($function) {
    @if type-of($function) != 'string' {
        @return null;
    }

    $scope-index: str-index($function, '@');

    @return if($scope-index, str-slice($function, 1, $scope-index - 1), $function);
}
